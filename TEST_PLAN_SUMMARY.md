# ‚úÖ –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç-–ø–ª–∞–Ω –¥–ª—è MyDailyOps Visibility Engine

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ **86 —Ç–µ—Å—Ç–æ–≤** –≤ 9 —Å–µ–∫—Ü–∏—è—Ö, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏—Ö –≤—Å—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É visibility engine.

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### **SECTION 1: BASE VISIBILITY CALCULATIONS** (10 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- duration 1/2/5/10/30 –¥–Ω–µ–π
- deadline —Å–µ–≥–æ–¥–Ω—è/–∑–∞–≤—Ç—Ä–∞/—á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é
- start_date vs deadline
- –∑–∞–¥–∞—á–∏ –≤ –ø—Ä–æ—à–ª–æ–º/–±—É–¥—É—â–µ–º

### **SECTION 2: TASKS WITH DEADLINE** (12 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- duration windows
- –ø–µ—Ä–µ—Ö–æ–¥—ã —á–µ—Ä–µ–∑ –ø–æ–ª–Ω–æ—á—å
- –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞
- –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω—é—é/–ø–æ–∑–¥–Ω—é—é –¥–∞—Ç—É

### **SECTION 3: TASKS WITHOUT DEADLINE** (10 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- start_date
- duration
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ created_at –≤–ª–∏—è–Ω–∏—è
- –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### **SECTION 4: TODAY BEHAVIOUR** (12 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- –∑–∞–¥–∞—á–∏ —Å deadline
- –∑–∞–¥–∞—á–∏ –±–µ–∑ deadline
- overdue
- visibility boundaries
- —Å–∫—Ä—ã—Ç–∏–µ completed –∑–∞–¥–∞—á

### **SECTION 5: UPCOMING (NEXT 7 DAYS)** (12 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- –∑–∞–¥–∞—á–∏, –≤–∏–¥–∏–º—ã–µ —á–µ—Ä–µ–∑ 1-7 –¥–Ω–µ–π
- –∑–∞–¥–∞—á–∏, –≤–∏–¥–∏–º—ã–µ —á–µ—Ä–µ–∑ 8+ –¥–Ω–µ–π
- –∑–∞–¥–∞—á–∏, —É–∂–µ –≤–∏–¥–∏–º—ã–µ —Å–µ–≥–æ–¥–Ω—è (–∏—Å–∫–ª—é—á–µ–Ω—ã)
- recurring tasks –≤ Upcoming

### **SECTION 6: RECURRING OCCURRENCES** (10 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- generation rules
- visibility rules
- overlapping durations
- recurring + no deadline
- recurring + long duration
- template must never appear

### **SECTION 7: DEADLINE CHANGE LOGIC** (8 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- –ø–µ—Ä–µ—Å—á—ë—Ç –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –ø–µ—Ä–µ–Ω–æ—Å —Ä–∞–Ω—å—à–µ
- –ø–µ—Ä–µ–Ω–æ—Å –ø–æ–∑–∂–µ
- duration –ø–µ—Ä–µ—Ä–∞—Å—á—ë—Ç
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö –≤–∏–¥–∏–º—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤

### **SECTION 8: TIMEZONE-STABLE EVENTS** (6 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- event_time –Ω–µ —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è
- local_time –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –¥—Ä—É–≥–æ–º —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ
- –≤–æ–∑–≤—Ä–∞—Ç –≤ –∏—Å—Ö–æ–¥–Ω—ã–π timezone
- recurring + timezone

### **SECTION 9: EDGE CASES** (8 —Ç–µ—Å—Ç–æ–≤)
‚úÖ –ü—Ä–æ–≤–µ—Ä—è—é—Ç:
- visible_from = today
- visible_until = today
- duration = 1
- missing fields
- null start_date fallback
- created_at is ignored
- tasks with deadlines in the past
- tasks created in future dates

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã:
```bash
cd apps/desktop
pnpm exec tsx test-visibility-comprehensive.ts
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å–µ–∫—Ü–∏—é:
```bash
pnpm exec tsx test-visibility-comprehensive.ts --section=1
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—Ü–∏–π:
```bash
pnpm exec tsx test-visibility-comprehensive.ts --section=1,2,3
```

### –ß–µ—Ä–µ–∑ npm script:
```bash
pnpm test:visibility              # –í—Å–µ —Ç–µ—Å—Ç—ã
pnpm test:visibility:section 1    # –°–µ–∫—Ü–∏—è 1
```

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

- ‚úÖ –í—Å–µ 86 —Ç–µ—Å—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã (SECTION 1 –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø–æ —Å–µ–∫—Ü–∏—è–º
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

---

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- ‚úÖ **Problem 4**: Upcoming (next 7 days) filtering
- ‚úÖ **Problem 5**: Deadline-anchored duration formula
- ‚úÖ **Visibility calculations**: –≤—Å–µ —Ñ–æ—Ä–º—É–ª—ã –∏ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏
- ‚úÖ **Today/Upcoming filtering**: –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã
- ‚úÖ **Recurring tasks**: visibility –¥–ª—è instances
- ‚úÖ **Deadline changes**: –ø–µ—Ä–µ—Å—á–µ—Ç –≤–∏–¥–∏–º–æ—Å—Ç–∏
- ‚úÖ **Timezone safety**: –¥–∞—Ç—ã –±–µ–∑ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ **Edge cases**: –≤—Å–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ CI/CD –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ

